#:import tr __main__.tr
#:import WipeTransition kivy.uix.screenmanager.WipeTransition
#:import SwapTransition kivy.uix.screenmanager.SwapTransition


<OneLineScheduleListItem>:
    text: ""

    IconLeftWidget:
        icon: "view-list"


    IconRightWidget:
        icon: "dots-vertical"
        on_release: app.show_schedule_item_options(root)


<ListItemWithCheckbox>:

    HomeworkListItemLeftActionContainer:
        id: _left_container

        MDCheckbox:
            on_release: app.mark_homework(root.id, self)

    IconRightWidget:
        icon: "dots-vertical"
        on_release: app.show_homework_item_options(root)

<ThreeLineLessonListItem>:
    text: ""

    IconLeftWidget:
        icon: "book-open-page-variant"

    IconRightWidget:
        icon: "dots-vertical"
        on_release: app.show_lesson_item_options(root)

ScreenManager:
    id: screen_manager
    transition: SwapTransition(duration=0.25)

    Screen:
        name: "start"
        on_pre_enter: app.on_screen_pre_enter(self)
        BoxLayout:
            id: start_screen_layout
            orientation: 'vertical'
            MDToolbar:
                id: start_top_toolbar
                title: "The Schedules"
                elevation: 8
                md_bg_color: app.theme_cls.primary_color
                right_action_items: [['cog', lambda x: app.open_settings()]]

            MDTabs:
                id: start_tabs
                on_tab_switch: app.on_start_tab_switch(*args)
                tab_indicator_anim: False
                tab_indicator_height: "4dp"
                elevation: 8

                Tab:
                    id: schedules_tab
                    text: "Schedules"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: schedule_list
                Tab:
                    id: homeworks_tab
                    text: "Homeworks"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: homework_list
        MDFloatingActionButton:
            icon: "plus"
            opposite_colors: True
            elevation_normal: 8
            pos_hint: {"center_x": .9, "center_y": .1}
            size: dp(56), dp(56)
            on_release: app.on_start_add_button_release()

    Screen:
        name: "add_schedule"
        BoxLayout:
            id: add_schedule_layout
            orientation: 'vertical'
            MDToolbar:
                id: add_schedule_top_toolbar
                title: "Add Schedule"
                elevation: 8
            ScrollView:
                do_scroll_x: False
                GridLayout:
                    padding: dp(30)
                    spacing: dp(20)
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height

                    MDTextField:
                        id: add_schedule_title
                        hint_text: 'Title'
                        padding_y: dp(20)
                        max_text_length: app.get_config_item('schedule_title_max_len')

    Screen:
        name: "add_homework_alt"

        BoxLayout:
            id: add_homework_layout_alt
            orientation: 'vertical'
            MDToolbar:
                id: add_homework_top_toolbar_alt
                title: "Select Date / Schedule / Lesson"
                elevation: 8

            ScrollView:
                MDBoxLayout:
                    orientation: "vertical"
                    padding: dp(48)
                    spacing: 10
                    size_hint_y: None
                    height: self.minimum_height

                    MDBoxLayout:
                        pos_hint: {"center_x": .5, "center_y": .5}
                        orientation: "vertical"

                        MDRoundFlatIconDateButton:
                            id: add_homework_date_alt
                            icon: "calendar"
                            text: ""
                            pos_hint: {"center_x": .5}
                            spacing: dp(12)
                            on_release: app.open_add_homework_datepicker()

                    MDSeparator:

                    MDStackLayout:
                        id: add_homework_schedules_wrapper
                        adaptive_size: True
                        pos_hint: {"center_x": .5}
                        spacing: dp(12)
                        size_hint: (1, None)

                    MDSeparator:

                    MDStackLayout:
                        id: add_homework_lessons_wrapper
                        adaptive_size: True
                        pos_hint: {"center_x": .5, "center_y": .5}
                        spacing: dp(12)
                        size_hint: (1, None)

                    MDSeparator:

                    MDBoxLayout:
                        orientation: "vertical"
                        size_hint_y: None
                        height: self.minimum_height

                        MDFillRoundFlatProceedButton:
                            id: add_homework_next_btn
                            text: "Proceed"
                            spacing: dp(12)
                            pos_hint: {"center_x": .5, "center_y": 1}
                            on_release: app.open_add_homework_alt()

    Screen:
        name: "add_lesson"
        BoxLayout:
            id: add_lesson_layout
            orientation: 'vertical'
            MDToolbar:
                id: add_lesson_top_toolbar
                title: "Add Lesson"
                elevation: 8
            ScrollView:
                do_scroll_x: False
                GridLayout:
                    id: add_lesson_grid_layout
                    padding: dp(30)
                    spacing: dp(20)
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height

                    MDTextField:
                        id: add_lesson_title
                        hint_text: 'Title'
                        padding_y: dp(20)
                        max_text_length: app.get_config_item('lesson_title_max_len')

    Screen:
        name: 'settings'
        BoxLayout:
            orientation: 'vertical'
            MDToolbar:
                id: settings_toolbar
                title: tr._('Settings')
                md_bg_color: app.theme_cls.primary_color
                elevation: 8
                left_action_items: [['arrow-left', lambda x: app.back_to_main()]]
            ScrollView:
                GridLayout:
                    padding: dp(20)
                    spacing: dp(10)
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height

                    MDLabel:
                        #text: f'[b]{tr._("Choose Language:")}[/b]'
                        text: tr._("Choose Language:")
                        #markup: True
                        #font_style: 'Jura'

                    MDSeparator:

                    MDChooseChip:
                        id: lang_select

                        MDChip:
                            label: tr._('English')
                            icon: ""
                            callback: app.change_lang
                            selected_chip_color: app.theme_cls.primary_color

                        MDChip:
                            label: tr._('Russian')
                            icon: ""
                            callback: app.change_lang
                            selected_chip_color: app.theme_cls.primary_color

                    MDLabel:
                        text: 'Choose Theme:'
                        #markup: True
                        #font_name: 'Jura'

                    MDSeparator:

                    MDChooseChip:
                        id: theme_select

                        MDChip:
                            label: 'Light'
                            icon: ""
                            callback: app.change_theme

                        MDChip:
                            label: 'Dark'
                            icon: ""
                            callback: app.change_theme

                    MDLabel:
                        text: 'Homework Notifications:'

                    MDSeparator:

                    MDTextButton:
                        id: notify_select
                        text: ""
                        on_release: app.set_notify_time_setting(self.text)

    Screen:
        name: "schedule"
        BoxLayout:
            id: schedule_screen_layout
            orientation: 'vertical'
            MDToolbar:
                id: schedule_toolbar
                title: "Schedule"
                elevation: 8
                md_bg_color: app.theme_cls.primary_color
                left_action_items: [['arrow-left', lambda x: app.back_to_main()]]

            MDTabs:
                id: schedule_tabs
                on_tab_switch: app.on_schedule_tab_switch(*args)
                tab_indicator_anim: True
                tab_indicator_height: "4dp"
                elevation: 8

                Tab:
                    id: tab_0
                    text: "Tab 0"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: lesson_list_day_0
                Tab:
                    id: tab_1
                    text: "Tab 1"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: lesson_list_day_1
                Tab:
                    id: tab_2
                    text: "Tab 2"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: lesson_list_day_2
                Tab:
                    id: tab_3
                    text: "Tab 3"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: lesson_list_day_3
                Tab:
                    id: tab_4
                    text: "Tab 4"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: lesson_list_day_4
                Tab:
                    id: tab_5
                    text: "Tab 5"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: lesson_list_day_5
                Tab:
                    id: tab_6
                    text: "Tab 6"
                    ScrollView:
                        do_scroll_x: False
                        MDList:
                            id: lesson_list_day_6


            MDBottomAppBar:
                MDToolbar:
                    id: bottom_schedule_toolbar
                    md_bg_color: app.theme_cls.primary_color
                    type: 'bottom'
                    title: 'Week'
                    mode: 'free-end'
                    icon: 'plus'
                    icon_color: app.theme_cls.accent_color
                    on_action_button: app.add_lesson()
                    right_action_items: [['page-previous', lambda x: app.week_back()], ['calendar-today', lambda x: app.week_current()], ['page-next', lambda x: app.week_next()]]

    Screen:
        name: "add_lesson_homework"
        BoxLayout:
            id: add_lesson_homework_layout
            orientation: 'vertical'
            MDToolbar:
                id: add_lesson_homework_top_toolbar
                title: "Add Homework"
                md_bg_color: app.theme_cls.primary_color
                elevation: 8
            ScrollView:
                do_scroll_x: False
                GridLayout:
                    padding: dp(30)
                    spacing: dp(20)
                    cols: 1
                    size_hint_y: None
                    height: self.minimum_height

                    MDLabel:
                        id: add_lesson_homework_subtitle
                        font_style: 'Subtitle1'
                        theme_text_color: 'Custom'
                        text_color: app.theme_cls.primary_color

                    MDTextField:
                        id: add_lesson_homework_desc_text
                        hint_text: "Describe your Homework here (max 50)"
                        padding_y: dp(20)
                        max_text_length: app.get_config_item('homework_desc_max_len')
